<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CRYSTALpytools.thermodynamics module &mdash; CRYSTALpytools 0.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="canonical" href="https://crystal-code-tools.github.io/CRYSTALpytools/crystalpytools.thermodynamics.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CRYSTALpytools.base.crysd12 module" href="crystalpytools.base.crysd12.html" />
    <link rel="prev" title="CRYSTALpytools.plot module" href="crystalpytools.plot.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            CRYSTALpytools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#create-a-conda-anaconda-environment">Create a conda/anaconda environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#install-crystalpytools">Install CRYSTALpytools</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#set-the-path-to-runcry-and-runprop">Set the path to runcry and runprop</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples_and_tutorials.html">Examples and Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="crystalpytools.html">Module-specific Docs</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="crystalpytools.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.adsorb.html">CRYSTALpytools.adsorb module</a></li>
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.calculate.html">CRYSTALpytools.calculate module</a></li>
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.convert.html">CRYSTALpytools.convert module</a></li>
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.crystal_io.html">CRYSTALpytools.crystal_io module</a></li>
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.execute.html">CRYSTALpytools.execute module</a></li>
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.plot.html">CRYSTALpytools.plot module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">CRYSTALpytools.thermodynamics module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="crystalpytools.html#developers">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.base.crysd12.html">CRYSTALpytools.base.crysd12 module</a></li>
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.base.crysout.html">CRYSTALpytools.base.crysout module</a></li>
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.base.propout.html">CRYSTALpytools.base.propout module</a></li>
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.base.inputbase.html">CRYSTALpytools.base.inputbase module</a></li>
<li class="toctree-l3"><a class="reference internal" href="crystalpytools.base.basisset.html">CRYSTALpytools.base.basisset module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CRYSTALpytools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="crystalpytools.html">CRYSTALpytools Package</a></li>
      <li class="breadcrumb-item active">CRYSTALpytools.thermodynamics module</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/crystal-code-tools/CRYSTALpytools/blob/main/docs_source/crystalpytools.thermodynamics.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-CRYSTALpytools.thermodynamics">
<span id="crystalpytools-thermodynamics-module"></span><h1>CRYSTALpytools.thermodynamics module<a class="headerlink" href="#module-CRYSTALpytools.thermodynamics" title="Permalink to this heading"></a></h1>
<p>A post-processing module for DFT lattice dynamics by harmonic and quasiharmonic
approximations (HA/QHA).</p>
<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Harmonic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Harmonic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autocalc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Harmonic" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class for harmonic phonon calclulations. It can be parameterized from a
CRYSTAL output file, phonopy ouput file or by setting all the information
(usually for QHA).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Temperatures
where thermodynamic properties are computed. Unit: K</p></li>
<li><p><strong>pressure</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Pressures where
the thermodyanmic properties are calculated. Unit: GPa</p></li>
<li><p><strong>filename</strong> (<em>str</em><em> | </em><em>None</em>) – Name of the printed-out file. If None, do not
print out file.</p></li>
<li><p><strong>autocalc</strong> (<em>bool</em>) – Automatically launch calculations.</p></li>
</ul>
</dd>
</dl>
<p>Temperatures and pressures can also be defined by <code class="docutils literal notranslate"><span class="pre">self.thermodynamics</span></code>,
whose entries always cover the entries here.</p>
<p>Phonon dispersions are forced to be summed if the automatic scheme
(<code class="docutils literal notranslate"><span class="pre">autocalc=True</span></code>) is launched. To get verbose outputs, call
<code class="docutils literal notranslate"><span class="pre">self.thermodynamics()</span></code> first and then call <code class="docutils literal notranslate"><span class="pre">self.print_results()</span></code>.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ha</span> <span class="o">=</span> <span class="n">Harmonic</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="n">pressure</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,])</span>
<span class="n">ha</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;harmonic_phonon.out&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Harmonic._phonon_sumup">
<span class="sig-name descname"><span class="pre">_phonon_sumup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_zp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Harmonic._phonon_sumup" title="Permalink to this definition"></a></dt>
<dd><p>Summing up inidival phonon modes at each q point. Translational modes
with frequencies = 0 are skipped. For thermodynamics, directly call
<code class="docutils literal notranslate"><span class="pre">self.thermodyanmics()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>float</em>) – </p></li>
<li><p><strong>calculate_zp</strong> (<em>bool</em>) – Calculate zero-point energy or temperature
dependent properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>zp_energy</strong> (<em>array[float]</em>) – Zero-point energy at a q point. Returned
if <code class="docutils literal notranslate"><span class="pre">calculate_zp</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p></li>
<li><p><strong>u_vib</strong> (<em>array[float]</em>) – Vibrational contribution to internal energy
at constant temperature and a q point. Returned if
<code class="docutils literal notranslate"><span class="pre">calculate_zp</span> <span class="pre">=</span> <span class="pre">False</span></code>.</p></li>
<li><p><strong>entropy</strong> (<em>array[float]</em>) – Entropy at constant temperature and a q
point. Returned if <code class="docutils literal notranslate"><span class="pre">calculate_zp</span> <span class="pre">=</span> <span class="pre">False</span></code>.</p></li>
<li><p><strong>c_v</strong> (<em>array[float]</em>) – Constant volume specific heat at constant
temperature and a q point. Returned if <code class="docutils literal notranslate"><span class="pre">calculate_zp</span> <span class="pre">=</span> <span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Harmonic.from_file">
<span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scelphono</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_eigvt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imaginary_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_overlap_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Harmonic.from_file" title="Permalink to this definition"></a></dt>
<dd><p>Generate the Harominc object from a HA output file. Imaginary modes and
overlapped q points are forced to be cleaned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_name</strong> (<em>str</em>) – Name of the output file.</p></li>
<li><p><strong>scellphono</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – The ‘SCELPHONO’ keyword in CRYSTAL input file. By default a
1*1*1 ‘SCELPHONO’ is assumed.</p></li>
<li><p><strong>read_eigvt</strong> (<em>bool</em>) – Whether to read eigenvectors from output.</p></li>
<li><p><strong>imaginary_tol</strong> (<em>float</em>) – The threshold of negative frequencies.</p></li>
<li><p><strong>q_overlap_tol</strong> (<em>float</em>) – The threshold of overlapping points, defined
as the 2nd norm of the difference of fractional q vectors</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self.structure</strong> (<em>PyMatGen Structure</em>) – Cell reduced by SCELPHONO.</p></li>
<li><p><strong>self.natom</strong> (<em>int</em>) – Number of atoms in the reduced cell.</p></li>
<li><p><strong>self.volume</strong> (<em>float</em>) – Volume of the reduced cell. Unit: Angstrom^3</p></li>
<li><p><strong>self.edft</strong> (<em>float</em>)</p></li>
<li><p><strong>self.nqpoint</strong> (<em>int</em>)</p></li>
<li><p><strong>self.qpoint</strong> (<em>list</em>)</p></li>
<li><p><strong>self.nmode</strong> (<em>array[int]</em>)</p></li>
<li><p><strong>self.mode</strong> (<em>list[Mode]</em>) – List of mode objects at all the qpoints.</p></li>
</ul>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If a QHA output file is read.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Harmonic.from_frequency">
<span class="sig-name descname"><span class="pre">from_frequency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imaginary_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_overlap_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_natom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Harmonic.from_frequency" title="Permalink to this definition"></a></dt>
<dd><p>Generate a Harmonic object by specifying frequency and eigenvector.
Imaginary modes and overlapped q points are forced to be cleaned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edft</strong> (<em>float</em>) – Electron total energy</p></li>
<li><p><strong>qpoint</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>array</em><em>[</em><em>float</em><em>]</em><em>, </em><em>float</em><em>]</em><em>]</em>) – Fractional coordinate
and weight of qpoint</p></li>
<li><p><strong>frequency</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Array of frequencies. Unit: THz</p></li>
<li><p><strong>eigenvector</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Normalized eigenvectors.</p></li>
<li><p><strong>structure</strong> (<em>Pymatgen Structure</em>) – </p></li>
<li><p><strong>natom</strong> (<em>int</em>) – </p></li>
<li><p><strong>volume</strong> (<em>float</em>) – </p></li>
<li><p><strong>imaginary_tol</strong> (<em>float</em>) – The threshold of negative frequencies.</p></li>
<li><p><strong>q_overlap_tol</strong> (<em>float</em>) – The threshold of overlapping points, defined
as the 2nd norm of the difference of fractional q vectors</p></li>
<li><p><strong>ignore_natom</strong> (<em>bool</em>) – Developer only.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The user should define either <code class="docutils literal notranslate"><span class="pre">structure</span></code> or <code class="docutils literal notranslate"><span class="pre">natom</span></code> + <code class="docutils literal notranslate"><span class="pre">volume</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self.structure</strong> (<em>PyMatGen Structure</em>) – Cell reduced by SCELPHONO.</p></li>
<li><p><strong>self.natom</strong> (<em>int</em>) – Number of atoms in the reduced cell.</p></li>
<li><p><strong>self.volume</strong> (<em>float</em>) – Volume of the reduced cell. Unit: Angstrom^3</p></li>
<li><p><strong>self.edft</strong> (<em>float</em>)</p></li>
<li><p><strong>self.nqpoint</strong> (<em>int</em>)</p></li>
<li><p><strong>self.qpoint</strong> (<em>list</em>)</p></li>
<li><p><strong>self.nmode</strong> (<em>array[int]</em>)</p></li>
<li><p><strong>self.mode</strong> (<em>list[Mode]</em>) – List of mode objects at all the qpoints.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AttributeError</strong> – If computational data is stored in the object.</p></li>
<li><p><strong>ValueError</strong> – If neither of the 2 available options are defined.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Harmonic.from_phonopy">
<span class="sig-name descname"><span class="pre">from_phonopy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phono_yaml</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">struc_yaml</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imaginary_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_overlap_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_coord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Harmonic.from_phonopy" title="Permalink to this definition"></a></dt>
<dd><p>Build a Harmonic object from <a class="reference external" href="https://phonopy.github.io/phonopy/">Phonopy</a>
‘band.yaml’ or ‘qpoints.yaml’ file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phono_yaml</strong> (<em>str</em>) – Phonopy band.yaml or qpoint.yaml file</p></li>
<li><p><strong>struc_yaml</strong> (<em>str</em>) – Phonopy phonopy.yaml or phonopy_disp.yaml file.
<em>Needed only if a qpoint.yaml file is read.</em></p></li>
<li><p><strong>edft</strong> (<em>float</em>) – DFT energy. Unit: kJ/mol</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – Scaling factor of phonon frequency.</p></li>
<li><p><strong>imaginary_tol</strong> (<em>float</em>) – The threshold of negative frequencies.</p></li>
<li><p><strong>q_overlap_tol</strong> (<em>float</em>) – The threshold of overlapping points, defined
as the 2nd norm of the difference of fractional q vectors</p></li>
<li><p><strong>q_id</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – Specify the id (from 0) of q points to be read.
nqpoint*1 list.</p></li>
<li><p><strong>q_coord</strong> (<em>list</em><em>[</em><em>list</em><em>]</em>) – Specify the coordinates of q points to be
read. nqpoint*3 list.</p></li>
</ul>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">q_id</span></code> and <code class="docutils literal notranslate"><span class="pre">q_coord</span></code> should not be set simultaneously. If set,
<code class="docutils literal notranslate"><span class="pre">q_id</span></code> takes priority and <code class="docutils literal notranslate"><span class="pre">q_coord</span></code> is ignored. If both are none,
all the points will be read.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Exception</strong> – If the length unit in yaml file is neither ‘au’ nor ‘angstrom’.</p></li>
<li><p><strong>Exception</strong> – If q point is not found.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Harmonic.thermodynamics">
<span class="sig-name descname"><span class="pre">thermodynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sumphonon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutewarning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Harmonic.thermodynamics" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the thermodynamic properties (zp_energy, u_vib, entropy, c_v
and Gibbs and Helmholtz free energy) of the HA system at all qpoints
and the whole temperature/pressure range.</p>
<p>Other parameters are the sum of corresponding attributes of all the
<code class="docutils literal notranslate"><span class="pre">Mode</span> <span class="pre">objects</span></code>. The Helmholtz and Gibbs free energies are defined as:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}F(p,V) = E_{DFT} + F_{vib}(T) = E_{DFT} + U_{vib}(T) - TS(T)\\G(p, V) = F + pV\end{aligned}\end{align} \]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Unit: K</p></li>
<li><p><strong>pressure</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Unit: GPa</p></li>
<li><p><strong>sumphonon</strong> (<em>bool</em>) – Whether to sum up the phonon contributions across
the sampled q points and take weighted-average.</p></li>
<li><p><strong>mutewarning</strong> (<em>bool</em>) – Whether print out warning messages of updated
temperature and pressure (For QHA).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self.helmholtz</strong> (<em>array[float]</em>) – nqpoint*ntemperature. Unit: KJ/mol</p></li>
<li><p><strong>self.gibbs</strong> (<em>array[float]</em>) – nqpoint*nPressure*nTemperature. Unit: KJ/mol</p></li>
<li><p><strong>self.zp_energy</strong> (<em>array[float]</em>) – Zero-point energy. nqpoint*1. Unit: KJ/mol</p></li>
<li><p><strong>self.u_vib</strong> (<em>array[float]</em>) – Vibrational contribution to internal
energy. nqpoint*ntemperature. Unit: KJ/mol</p></li>
<li><p><strong>self.entropy</strong> (<em>array[float]</em>) – nqpoint*ntemperature. Unit: J/mol*K</p></li>
<li><p><strong>self.c_v</strong> (<em>array[float]</em>) – Constant volume specific heat.
nqpoint*ntemperature. Unit: J/mol*K</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">sumphonon</span> <span class="pre">=</span> <span class="pre">True</span></code>, nqpoint = 1.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AttributeError</strong> – If temperature and pressure are defined neither here nor during initialization</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Harmonic.write_HA_result">
<span class="sig-name descname"><span class="pre">write_HA_result</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Harmonic.write_HA_result" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Mode">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigenvector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Mode" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Defines a vibrational mode and do analysis per mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rank</strong> (<em>int</em>) – The rank of the mode object, from 1.</p></li>
<li><p><strong>frequency</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em>) – Frequencies of the mode
(Ncalc*1). Unit: THz. Note: <strong>NOT</strong> angular frequency, which is
frequency * 2pi.</p></li>
<li><p><strong>volume</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em>) – Lattice volumes of harmonic
calculations (Ncalc*1). Unit: Angstrom^3</p></li>
<li><p><strong>eigenvector</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em>) – Corresponding normalized
eigenvectors (Ncalc*Natom*3).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self.rank</strong> (<em>int</em>)</p></li>
<li><p><strong>self.ncalc</strong> (<em>int</em>) – The number of harmonic calculations (typically at
different volumes)</p></li>
<li><p><strong>self.frequency</strong> (<em>array[float]</em>)</p></li>
<li><p><strong>self.volume</strong> (<em>array[float]</em>)</p></li>
<li><p><strong>self.eigenvector</strong> (<em>array[float]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Mode.get_c_v">
<span class="sig-name descname"><span class="pre">get_c_v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Mode.get_c_v" title="Permalink to this definition"></a></dt>
<dd><p>Get the constant volume specific heat of a single mode. <em>ncalc = 1 only</em>.</p>
<div class="math notranslate nohighlight">
\[C^{V}_{i,\mathbf{q}}=
\frac{\left(\hbar\omega_{i,\mathbf{q}}\right)^{2}}{k_{B}T^{2}}
\frac{\exp{
\left(
    \frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T}
\right)}
}{\left[
    \exp{\left(
        \frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T}
    \right)-1}
\right]^{2}
}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – Unit: K</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.c_v</strong> (<em>float</em>) – Constant volume specific heat. Unit: J/mol*K</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Mode.get_entropy">
<span class="sig-name descname"><span class="pre">get_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Mode.get_entropy" title="Permalink to this definition"></a></dt>
<dd><p>Get the entropy of a single mode. <em>ncalc = 1 only</em>.</p>
<div class="math notranslate nohighlight">
\[S_{i,\mathbf{q}}\left(T\right)=k_{B}\left\{
    \frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T\left[
        \exp{\left(
            \frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T}
        \right)}-1
    \right]}-\ln{\left[
        1-\exp{\left(
            -\frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T}
        \right)}
    \right]}
\right\}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – Unit: K</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.entropy</strong> (<em>float</em>) – Entropy. Unit: J/mol*K</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Mode.get_gruneisen">
<span class="sig-name descname"><span class="pre">get_gruneisen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Mode.get_gruneisen" title="Permalink to this definition"></a></dt>
<dd><p>Return to mode Grüneisen parameter. <em>ncalc &gt; 1 only</em>.</p>
<div class="math notranslate nohighlight">
\[\gamma = -\frac{V}{\omega(V)}\frac{\partial\omega}{\partial V}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<em>int</em><em> | </em><em>list</em><em>[</em><em>int</em><em>]</em>) – See <code class="docutils literal notranslate"><span class="pre">polynomial_fit</span></code></p></li>
<li><p><strong>volume</strong> (<em>float</em><em> | </em><em>array</em>) – Typically the equilibrium volume</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.gruneisen</strong> (<em>dict</em>) – Key, order; Value, Gruneisen parameter</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Mode.get_u_vib">
<span class="sig-name descname"><span class="pre">get_u_vib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">298.15</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Mode.get_u_vib" title="Permalink to this definition"></a></dt>
<dd><p>Get the vibration contribution to internal energy (including zero-point
energy) of a single mode. <em>ncalc = 1 only</em>.</p>
<div class="math notranslate nohighlight">
\[U^{vib}_{i,\mathbf{q}}\left(T\right)=E^{zp}_{i,\mathbf{q}}+
\frac{\hbar\omega_{i,\mathbf{q}}}{\exp{\left(
    \frac{\hbar\omega_{i,\mathbf{q}}}{k_{B}T}
\right)}-1}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – Temperature where the quantity is
computed. Unit: K</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.u_vib</strong> (<em>float</em>) – Vibration contribution to internal energy.
Unit: KJ/mol</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Mode.get_zp_energy">
<span class="sig-name descname"><span class="pre">get_zp_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Mode.get_zp_energy" title="Permalink to this definition"></a></dt>
<dd><p>Get the zero-point energy of a single mode. <em>ncalc = 1 only</em>.</p>
<div class="math notranslate nohighlight">
\[E^{zp}_{i,\mathbf{q}}=\frac{1}{2}\hbar\omega_{i,\mathbf{q}}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self.zp_energy</strong> (<em>float</em>) – Zero-point energy. Unit: KJ/mol</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Mode.polynomial_fit">
<span class="sig-name descname"><span class="pre">polynomial_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">3]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Mode.polynomial_fit" title="Permalink to this definition"></a></dt>
<dd><p>Fit phonon frequency as the polynomial function of volume. <em>ncalc &gt; 1 only</em>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To improve the accuracy of fittings, <span class="math notranslate nohighlight">\(\Delta\omega(\Delta V)\)</span>
is fitted as a polynomial function without the constant term.</p>
<p><span class="math notranslate nohighlight">\(\Delta V=V-V_{min}\)</span> is used so HA phonons of the most compact
structure is kept. See ‘FIXINDEX’ keyword in CRYSTAL manual for
further information.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<em>array</em><em>[</em><em>int</em><em>] </em><em>| </em><em>list</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Orders of polynomials.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>self.poly_fit</strong> (<em>Dict[int, NumPy Polynomial]</em>) – Key - orders of power,
Value - fitted NumPy polynomials</p></li>
<li><p><strong>self.poly_fit_rsquare</strong> (<em>Dict[int, float]</em>) – Key - orders of power,
Value - goodness of fittings, characterized by R^2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Output">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Output</span></span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Output" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Deal with output data file</p>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Output.write_HA_result">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_HA_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Output.write_HA_result" title="Permalink to this definition"></a></dt>
<dd><p>Write harmonic phonon information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ha</strong> (<a class="reference internal" href="#CRYSTALpytools.thermodynamics.Harmonic" title="CRYSTALpytools.thermodynamics.Harmonic"><em>Harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Harmonic</span></code> object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Output.write_QHA_combinedata">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_QHA_combinedata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Output.write_QHA_combinedata" title="Permalink to this definition"></a></dt>
<dd><p>Write QHA combined phonon information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic" title="CRYSTALpytools.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code> object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Output.write_QHA_eosfit">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_QHA_eosfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Output.write_QHA_eosfit" title="Permalink to this definition"></a></dt>
<dd><p>Write QHA phonon eos fit information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic" title="CRYSTALpytools.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p></li>
<li><p><strong>order</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – Orders of polynomials</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Name of EoS used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Output.write_QHA_polyfit">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_QHA_polyfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsquare_q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Output.write_QHA_polyfit" title="Permalink to this definition"></a></dt>
<dd><p>Write QHA phonon polynomial fit information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic" title="CRYSTALpytools.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p></li>
<li><p><strong>order</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – List of polynomial orders.</p></li>
<li><p><strong>rsquare_q</strong> (<em>array</em>) – Nqpoint*Norder list. Overall goodness at a q point.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Output.write_QHA_sortphonon">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_QHA_sortphonon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">close_overlap</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Output.write_QHA_sortphonon" title="Permalink to this definition"></a></dt>
<dd><p>Write QHA phonon sort information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic" title="CRYSTALpytools.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p></li>
<li><p><strong>close_overlap</strong> (<em>array</em><em>[</em><em>bool</em><em>]</em>) – ncalc*nmode*nmode. Whether close
overlap is identified between the previous calculation (2nd
dimension) and the current one (3rd).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Output.write_QHA_thermoeos">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_QHA_thermoeos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Output.write_QHA_thermoeos" title="Permalink to this definition"></a></dt>
<dd><p>Write QHA thermodynamics information (EOS fitting).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic" title="CRYSTALpytools.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Output.write_QHA_thermofreq">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_QHA_thermofreq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume_bound</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Output.write_QHA_thermofreq" title="Permalink to this definition"></a></dt>
<dd><p>Write QHA thermodynamics information (frequency fitting).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic" title="CRYSTALpytools.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Output.write_QHA_thermogru">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_QHA_thermogru</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Output.write_QHA_thermogru" title="Permalink to this definition"></a></dt>
<dd><p>Write QHA thermodynamics information (Grüneisen fitting).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic" title="CRYSTALpytools.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Output.write_bulk_modulus">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_bulk_modulus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adiabatic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Output.write_bulk_modulus" title="Permalink to this definition"></a></dt>
<dd><p>Write bulk moduli.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic" title="CRYSTALpytools.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <dl class="simple">
<dt><code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code></dt><dd><p>object.</p>
</dd>
<dt>adiabatic (bool): Whether the adiabatic bulk modulus <span class="math notranslate nohighlight">\(K_{S}\)</span></dt><dd><p>is fitted.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Output.write_expansion_latt">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_expansion_latt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_square</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Output.write_expansion_latt" title="Permalink to this definition"></a></dt>
<dd><p>Write linear expansion information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic" title="CRYSTALpytools.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p></li>
<li><p><strong>e_err</strong> (<em>array</em>) – RMS deviation of Gibbs free energy at T and p.</p></li>
<li><p><strong>fit_order</strong> (<em>array</em>) – The order of polynomials used for fitting
lattice parameter.</p></li>
<li><p><strong>r_square</strong> (<em>array</em>) – R^2 of fitting. nLatt*nPress</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Output.write_expansion_vol">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_expansion_vol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_rs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Output.write_expansion_vol" title="Permalink to this definition"></a></dt>
<dd><p>Write volumetric thermal expansions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic" title="CRYSTALpytools.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p></li>
<li><p><strong>fit_order</strong> (<em>int</em>) – The order of polynomial used for fitting.</p></li>
<li><p><strong>fit_rs</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – R^2 of fitting. nPressure*1 list.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Output.write_specific_heat">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">write_specific_heat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Output.write_specific_heat" title="Permalink to this definition"></a></dt>
<dd><p>Write bulk moduli.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qha</strong> (<a class="reference internal" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic" title="CRYSTALpytools.thermodynamics.Quasi_harmonic"><em>Quasi_harmonic</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.thermodynamic.Quasi_harmonic</span></code>
object.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Quasi_harmonic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generate and rearrange harmonic phonons, store the fitted, volume-dependent
QHA phonon information and obtain the QHA thermodynamic properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Unit: K</p></li>
<li><p><strong>pressure</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Unit: GPa</p></li>
<li><p><strong>write_out</strong> (<em>bool</em>) – Whether to print the key information into a file.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Name of the output file. Valid if <code class="docutils literal notranslate"><span class="pre">write_out</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>Temperatures and pressures can also be defined by <code class="docutils literal notranslate"><span class="pre">self.thermodynamics</span></code>,
whose entries always cover the entries here.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qha</span> <span class="o">=</span> <span class="n">Quasi_harmonic</span><span class="p">()</span>
<span class="n">qha</span><span class="o">.</span><span class="n">from_QHA_file</span><span class="p">(</span><span class="s1">&#39;qha_phonon.out&#39;</span><span class="p">)</span>
<span class="n">qha</span><span class="o">.</span><span class="n">thermo_freq</span><span class="p">(</span><span class="n">eos_method</span><span class="o">=</span><span class="s1">&#39;birch_murnaghan&#39;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="n">pressure</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]):</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic._clean_attr">
<span class="sig-name descname"><span class="pre">_clean_attr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic._clean_attr" title="Permalink to this definition"></a></dt>
<dd><p>When temperature / pressure are changed, thermodynamic attributes are
removed to keep consistency.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic._combine_data">
<span class="sig-name descname"><span class="pre">_combine_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ha_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_sort_tol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic._combine_data" title="Permalink to this definition"></a></dt>
<dd><p>Combine the HA calculation data and rearrange it in the ascending order
of volumes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ha_list</strong> (<em>list</em><em>[</em><a class="reference internal" href="#CRYSTALpytools.thermodynamics.Harmonic" title="CRYSTALpytools.thermodynamics.Harmonic"><em>Harmonic</em></a><em>]</em>) – List of harmonic objects.</p></li>
<li><p><strong>mode_sort_tol</strong> (<em>float</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>combined_phonon</strong> (<em>list[Harmonic]</em>)</p></li>
<li><p><strong>combined_volume</strong> (<em>list[float]</em>)</p></li>
<li><p><strong>combined_edft</strong> (<em>list[float]</em>)</p></li>
<li><p><strong>combined_mode</strong> (<em>list[Mode]</em>)</p></li>
</ul>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If number of q points, modes or atoms are not consistent across the HA calculations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic._get_harmonic_phonon">
<span class="sig-name descname"><span class="pre">_get_harmonic_phonon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic._get_harmonic_phonon" title="Permalink to this definition"></a></dt>
<dd><p>Get numerical phonon frequencies from fitted analytical expressions and
generate harmonic phonon objects. Not a standalone method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>volume</strong> (<em>float</em>) – Unit: Angstrom^3</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ha</strong> (<em>Harmonic</em>) – Harmonic phonon object with numerical data.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If frequency is not fitted as function of volumes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic._minimize_gibbs">
<span class="sig-name descname"><span class="pre">_minimize_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic._minimize_gibbs" title="Permalink to this definition"></a></dt>
<dd><p>Get Gibbs free energy from the Harmonic phonon object. Used only for
minimizing <span class="math notranslate nohighlight">\(G(V;T, p)\)</span> by SciPy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volume</strong> (<em>float</em>) – </p></li>
<li><p><strong>temperature</strong> (<em>float</em>) – </p></li>
<li><p><strong>pressure</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ha.gibbs</strong> (<em>float</em>) – Gibbs free energy. Unit: KJ/mol</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic._minimize_latt">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_minimize_latt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fe_eq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latt_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fe_ref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic._minimize_latt" title="Permalink to this definition"></a></dt>
<dd><p>Minimize the RMSD between pHp^T and the difference of Gibbs free
energy. For Scipy. For fitting lattice parameters in <code class="docutils literal notranslate"><span class="pre">self.expansion_vol</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic._phonon_continuity">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_phonon_continuity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigvt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_sort_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic._phonon_continuity" title="Permalink to this definition"></a></dt>
<dd><p>Rearrange phonon modes by their continuity. If the difference between
the maximum scalar product of corresponding eigenvectors (normalized to
1) and scalar products of other modes is less than 0.4, warning is
printed due to the potential overlap of modes. Adopted from CRYSTAL17.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="upperalpha simple">
<li><p>Erba, <em>J. Chem. Phys.</em>, 2014, <strong>141</strong>, 124115.</p></li>
</ol>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>freq</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Phonon frequencies. Unit: THz</p></li>
<li><p><strong>eigvt</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Eigenvectores normalized to 1</p></li>
<li><p><strong>symm</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Sub-group numbers of corresponding modes.
<em>Not implemented</em></p></li>
<li><p><strong>mode_sort_tol</strong> (<em>float</em>) – The threshold of close mode overlaps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>freq</strong> (<em>array[float]</em>) – Sorted phonon frequencies</p></li>
<li><p><strong>eigvt</strong> (<em>array[float]</em>) – Sorted eigenvectores</p></li>
<li><p><strong>close_overlap</strong> (<em>array[bool]</em>) – ncalc*nmode*nmode. Whether close
overlap is identified between the previous calculation (2nd
dimension) and the current one (3rd).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic._poly_no_cst">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_poly_no_cst</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic._poly_no_cst" title="Permalink to this definition"></a></dt>
<dd><p>Define a polynomial <span class="math notranslate nohighlight">\(\Delta f(\Delta x)\)</span> without constant term.
Orders low to high. For SciPy. Functions of vectors not supported.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.bulk_modulus">
<span class="sig-name descname"><span class="pre">bulk_modulus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adiabatic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.bulk_modulus" title="Permalink to this definition"></a></dt>
<dd><p>Calculate isothermal and adiabatic bulk moduli at equilibrium volumes.</p>
<p>The following equations are used:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}K_{T}(p;T) = V(p;T)\left(\frac{\partial^{2}F(V;T)}{\partial V^{2}}\right)_{T}\\K_{S} = K_{T} + \frac{\alpha^{2}_{V}VTK^{2}_{T}}{C_{V}}\end{aligned}\end{align} \]</div>
<p>To get <span class="math notranslate nohighlight">\(K_{T}\)</span>, Helmholtz free energy is fit as isothermal EOSs.
For <code class="docutils literal notranslate"><span class="pre">self.thermo_eos()</span></code>, that means doing nothing; For
<code class="docutils literal notranslate"><span class="pre">self.thermo_freq()</span></code>, EOS fitting is required, whose form is the same
as EOS used for <span class="math notranslate nohighlight">\(E_{0}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adiabatic</strong> (<em>bool</em>) – Whether to fit adiabatic bulk modulus. Thermal
expansion coefficient needed.</p></li>
<li><p><strong>order</strong> – (int, optional): To restore EOS.</p></li>
<li><p><strong>min_ndata_factor</strong> – (int, optional): To restore EOS.</p></li>
<li><p><strong>max_poly_order_factor</strong> – (int, optional): To restore EOS.</p></li>
<li><p><strong>min_poly_order_factor</strong> – (int, optional): To restore EOS.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> (<em>Quasi_harmonic</em>)</p>
</dd>
</dl>
<p><strong>New attributes</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self.k_t</span></code> nPressure*nTemperature array, isothermal bulk modulus.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.k_s</span></code> nPressure*nTemperature array, adiabatic bulk modulus.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.eos_fit">
<span class="sig-name descname"><span class="pre">eos_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.eos_fit" title="Permalink to this definition"></a></dt>
<dd><p>Fit energy-volume relationship by equation of states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volume</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Unit: Angstrom^3</p></li>
<li><p><strong>energy</strong> (<em>array</em><em>[</em><em>float</em><em>]</em>) – Unit: kJ/mol</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Name of EoS used. Consistent with
<a class="reference external" href="https://pymatgen.org/pymatgen.analysis.eos.html">Pymatgen</a>.</p></li>
<li><p><strong>write_out</strong> (<em>bool</em>) – Whether to print EOS information.</p></li>
<li><p><strong>order</strong> (<em>int</em>) – For DeltaFactor / Polynomial methods.</p></li>
<li><p><strong>min_ndata_factor</strong> (<em>int</em>) – For the NumericalEOS method.</p></li>
<li><p><strong>max_poly_order_factor</strong> (<em>int</em>) – For the NumericalEOS method.</p></li>
<li><p><strong>min_poly_order_factor</strong> (<em>int</em>) – For the NumericalEOS method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>eos</strong> (<em>Pymatgen EOS</em>) – The fitted equation of state.</p></li>
<li><p><strong>eos_method</strong> (<em>string</em>) – Name of the fitted equation of state</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.expansion_lin">
<span class="sig-name descname"><span class="pre">expansion_lin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poly_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.expansion_lin" title="Permalink to this definition"></a></dt>
<dd><p>Fit linear expansions of lattice parameters by the 2-order Taylor
expansion.</p>
<div class="math notranslate nohighlight">
\[G(\mathbf{p})=G_{0}(\mathbf{p_{0}})+\Delta\mathbf{p}^{T}\mathbf{H}\Delta\mathbf{p}\]</div>
<p>:math::<cite>G</cite> is Gibbs free energy. <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> is the vector
of lattice parameters. <span class="math notranslate nohighlight">\(\Delta\mathbf{p}\)</span> means the
difference between the fitted and equilibrium lattice parameters.
<span class="math notranslate nohighlight">\(\mathbf{H}\)</span> is the Hessian of <span class="math notranslate nohighlight">\(G\)</span> and displacements
along lattice parameters.</p>
<p>The RMS deviations (RMSD) of the following equation is minimized
at constant temperature and pressure. But deviations from
equilibrium volume might occur. RMSD of Gibbs free energy is
available in output file only.</p>
<div class="math notranslate nohighlight">
\[\mathbf{p_{0}} = \min\left\{\Delta\mathbf{p}^{T}\mathbf{H}\Delta\mathbf{p} - [G(\mathbf{p})-G_{0}(T,p)]\right\}\]</div>
<p>This method requires a larger number of HA calculations to ensure
a small RMSD. Typically the number of HA calculations should
follow the equation below, otherwise the warning massage is given.</p>
<div class="math notranslate nohighlight">
\[n_{HA} \geq n_{latt} + \sum_{i=1}^{n_{latt}}i\]</div>
<p><span class="math notranslate nohighlight">\(n_{latt}\)</span> is the lenth of the minimial set of lattice parameters.
The optimized lattice parameters at DFT level are used for fitting.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="upperalpha simple" start="14">
<li><p>Raimbault, V. Athavale and M. Rossi, <em>Phys. Rev. Materials</em>, 2019, <strong>3</strong>, 053605.</p></li>
</ol>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>poly_order</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – Order of polynomials used to fit the
linear expansion coefficients. The optimal fit across the
sampled temperature and pressure range of a certain lattice
parameter is automatically chosen based on <span class="math notranslate nohighlight">\(R^{2}\)</span>.</p></li>
<li><p><strong>interp</strong> (<em>int</em>) – Number of interpolated geometries. All the HA
geometries are used besides the interpolated ones.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> (<em>Quasi_harmonic</em>)</p>
</dd>
</dl>
<p><strong>New attributes</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self.lattice</span></code> nPressure*nTemperature*nLattice array. The</p></li>
</ul>
<p>equilibrium values of minimal set of lattice parameters.
* <code class="docutils literal notranslate"><span class="pre">self.latt_fit</span></code> nPressure*nLattice list of Numpy polynomial
object, the fitted a(v). Linear part only.
* <code class="docutils literal notranslate"><span class="pre">self.alpha_latt</span></code> nPressure*nTemperature*nLattice array.
Linear expansion coefficients. Linear part only.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.expansion_vol">
<span class="sig-name descname"><span class="pre">expansion_vol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poly_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'expansion_fit.png'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.expansion_vol" title="Permalink to this definition"></a></dt>
<dd><p>Fit the thermal expansion curve and get thermal expansion coefficients
at equilibrium volumes.</p>
<p>The volumetric thermal expansion coefficient at constant pressure:</p>
<div class="math notranslate nohighlight">
\[\alpha_{V}(T) = \frac{1}{V(T)}\left(\frac{\partial V(T)}{\partial T}\right)_{p}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>poly_order</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – <em>method = ‘polynomial’</em>, order of polynomials.</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – Plot V-T curves to examine the goodness of fitting. An
interactive window will pump out to let user to specify the
optimial fitting.</p></li>
<li><p><strong>fit_fig</strong> (<em>str</em>) – File name for fittings. A temperal figure is printed
to help the user choose the optimal fitting.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> (<em>Quasi_harmonic</em>)</p>
</dd>
</dl>
<p><strong>New attributes</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self.vol_fit</span></code> nPressure*1 list of Numpy polynomial object,</p></li>
</ul>
<p>the fitted volume V(T)
* <code class="docutils literal notranslate"><span class="pre">self.alpha_v</span></code> nPressure*nTemperature array, expansion
coefficients at equilibrium volumes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.freq_polynomial_fit">
<span class="sig-name descname"><span class="pre">freq_polynomial_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.freq_polynomial_fit" title="Permalink to this definition"></a></dt>
<dd><p>Fit phonon frequencies as polynomial functions of volumes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>order</strong> (<em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>array</em><em>[</em><em>int</em><em>]</em>) – The order of polynomials used.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.fit_order</strong> (<em>int</em>) – The optimal order of polynomial fit.</p>
</dd>
</dl>
<p>Please also refer to <code class="docutils literal notranslate"><span class="pre">self.poly_fit</span></code> and <code class="docutils literal notranslate"><span class="pre">self.poly_fit_rsquare</span></code>
attributes of Mode class.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.from_HA_files">
<span class="sig-name descname"><span class="pre">from_HA_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scelphono</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imaginary_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_overlap_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_sort_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.from_HA_files" title="Permalink to this definition"></a></dt>
<dd><p>Read data from individual HA calculation outputs. Imaginary modes and
overlapped q points are forced to be cleaned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_files</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of phonon output filenames.</p></li>
<li><p><strong>scelphono</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em>) – Corresponds to the
‘SCELPHONO’ keyword in CRYSTAL. Either 3*3 or ndimension*ndimension.
By default a 1*1*1 ‘SCELPHONO’ is assumed.</p></li>
<li><p><strong>imaginary_tol</strong> (<em>float</em>) – The threshold of negative frequencies.</p></li>
<li><p><strong>q_overlap_tol</strong> (<em>float</em>) – The threshold of overlapping points, defined
as the 2nd norm of the difference of fractional q vectors</p></li>
<li><p><strong>mode_sort_tol</strong> (<em>float</em><em> | </em><em>None</em>) – The threshold of close mode
overlaps. If none, do not sort modes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> (<em>Quasi_harmonic</em>)</p>
</dd>
</dl>
<p><strong>New Attributes</strong></p>
<ul class="simple">
<li><p>self.ncalc (int): Number of HA phonon calculations.</p></li>
<li><p>self.combined_phonon (list[Harmonic]): List of Harmonic objects.</p></li>
<li><p>self.combined_volume (list[float]): Volumes. Unit: Angstrom^3</p></li>
<li><p>self.combined_edft (list[float]): DFT total energies. Unit: KJ/mol</p></li>
<li><p>self.combined_mode (list[Mode]): List of mode objects.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.from_QHA_file">
<span class="sig-name descname"><span class="pre">from_QHA_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scelphono</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imaginary_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_overlap_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_sort_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.from_QHA_file" title="Permalink to this definition"></a></dt>
<dd><p>Read data from a single QHA calculation at Gamma point. Imaginary modes
and overlapped q points are forced to be cleaned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_files</strong> (<em>str</em><em> | </em><em>list</em><em>[</em><em>str</em><em>]</em>) – Only 1 QHA file is permitted.</p></li>
<li><p><strong>scelphono</strong> (<em>array</em><em>[</em><em>float</em><em>] </em><em>| </em><em>list</em><em>[</em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>imaginary_tol</strong> (<em>float</em>) – The threshold of negative frequencies.</p></li>
<li><p><strong>q_overlap_tol</strong> (<em>float</em>) – The threshold of overlapping points, defined
as the 2nd norm of the difference of fractional q vectors</p></li>
<li><p><strong>mode_sort_tol</strong> (<em>float</em><em> | </em><em>None</em>) – The threshold of close mode
overlaps. If none, do not sort modes.</p></li>
</ul>
</dd>
</dl>
<p>Returned attributes are consistent with <code class="docutils literal notranslate"><span class="pre">Quasi_harmonic.from_HA_files</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If multiple files are defined.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.from_phonopy_files">
<span class="sig-name descname"><span class="pre">from_phonopy_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phono_yaml</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">struc_yaml</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imaginary_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_overlap_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_coord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.from_phonopy_files" title="Permalink to this definition"></a></dt>
<dd><p>Build a QHA object from <a class="reference external" href="https://phonopy.github.io/phonopy/">Phonopy</a>
‘band.yaml’ or ‘qpoints.yaml’ file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phono_yaml</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – ncalc*1 list of Phonopy band.yaml or
qpoint.yaml files</p></li>
<li><p><strong>struc_yaml</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – ncalc*1 list of Phonopy phonopy.yaml or
phonopy_disp.yaml files. <em>Needed only if a qpoint.yaml file is
read.</em></p></li>
<li><p><strong>edft</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – ncalc*1 list / array of DFT energies.</p></li>
<li><p><strong>imaginary_tol</strong> (<em>float</em>) – The threshold of negative frequencies.</p></li>
<li><p><strong>q_overlap_tol</strong> (<em>float</em>) – The threshold of overlapping points, defined
as the 2nd norm of the difference of fractional q vectors</p></li>
<li><p><strong>q_id</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – See <code class="docutils literal notranslate"><span class="pre">Harmonic.from_phonopy</span></code>.</p></li>
<li><p><strong>q_coord</strong> (<em>list</em><em>[</em><em>list</em><em>]</em>) – See <code class="docutils literal notranslate"><span class="pre">Harmonic.from_phonopy</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">q_id</span></code> and <code class="docutils literal notranslate"><span class="pre">q_coord</span></code> should be set once and are applicable to
all the yaml files.</p>
</div>
<p>Returned attributes are consistent with <code class="docutils literal notranslate"><span class="pre">Quasi_harmonic.from_HA_files</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.specific_heat">
<span class="sig-name descname"><span class="pre">specific_heat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.specific_heat" title="Permalink to this definition"></a></dt>
<dd><p>Calculate constant volume or pressure specific heat at equilibrium
volumes.</p>
<p>The following equation is used:</p>
<div class="math notranslate nohighlight">
\[C_{p} - C_{V} = \alpha_{V}^{2}K_{T}VT\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<em>Quasi_harmonic</em>)</p>
</dd>
</dl>
<p><strong>New attributes</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self.c_v</span></code> or <code class="docutils literal notranslate"><span class="pre">self.c_p</span></code>  Dependents on the fitting method.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method fits <code class="docutils literal notranslate"><span class="pre">self.c_p</span></code> by <code class="docutils literal notranslate"><span class="pre">self.c_v</span></code> when <code class="docutils literal notranslate"><span class="pre">thermo_freq</span></code>
and <code class="docutils literal notranslate"><span class="pre">thermo_gruneisen</span></code> was used. <code class="docutils literal notranslate"><span class="pre">self.c_v</span></code> is obtained by when
<code class="docutils literal notranslate"><span class="pre">thermo_eos</span></code> is used.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.thermo_eos">
<span class="sig-name descname"><span class="pre">thermo_eos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eos_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'birch_murnaghan'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutewarning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.thermo_eos" title="Permalink to this definition"></a></dt>
<dd><p>Obtain thermodynamic properties by fitting EOS, which is fitted by the
Helmholtz free energies of sampled harmonic phonons. The explicit
sorting and fitting of frequency-volume relationship is disabled.</p>
<p>Entropy is obtained by taking the derivation of Gibbs free energy at
constant pressure.</p>
<div class="math notranslate nohighlight">
\[S=-\left(\frac{\partial G}{\partial T}\right)_{p}\]</div>
<p>Constant pressure specific heat is obtained by taking the second
derivative of <span class="math notranslate nohighlight">\(G\)</span>.</p>
<div class="math notranslate nohighlight">
\[C_{p}=-T\left(\frac{\partial^{2}G}{\partial T^{2}}\right)_{p}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">poly_order</span></code> should &gt;= 2.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<em>Quasi_harmonic</em>)</p>
</dd>
</dl>
<p><strong>New attributes</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self.c_p</span></code>, nPressure*nTemperature, Constant pressure specific heat. Unit: J/mol*K</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.fe_eos</span></code> and <code class="docutils literal notranslate"><span class="pre">self.fe_eos_method</span></code> nTemperature*1 list of Pymatgen EOS objects and string. EOSs used to fit HA free energy at constant temperature.</p></li>
</ul>
<p>For arguments and other attributes, see <code class="docutils literal notranslate"><span class="pre">Quasi_harmonic.thermo_freq</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Exception</strong> – If the number of HA calculations is less than 4.</p></li>
<li><p><strong>ValueError</strong> – If temperature or pressure is defined neither here nor during initialization.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.thermo_freq">
<span class="sig-name descname"><span class="pre">thermo_freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eos_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'birch_murnaghan'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BFGS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutewarning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.thermo_freq" title="Permalink to this definition"></a></dt>
<dd><p>Obtain thermodynamic properties by explicitly fitting phonon
frequencies as polynomial functions of volume. DFT total energies are
fitted as a function of volume by equation of states (EOS).</p>
<p>The equilibrium volume is fitted by minimizing Gibbs free energy at
constant temperature and pressure.</p>
<div class="math notranslate nohighlight">
\[V(T,p)=\text{min}[G(V;T,p)]=\text{min}[E_{0}(V)+F_{vib}(V;T,p)+pV)]\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eos_method</strong> (<em>str</em><em>, </em><em>optional</em>) – EOS used to fit DFT total energy and
Helmholtz free energy (to get bulk modules).</p></li>
<li><p><strong>poly_order</strong> (<em>array</em><em>[</em><em>int</em><em>] </em><em>| </em><em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – The order of
polynomials used to fit frequency as the function of volumes.</p></li>
<li><p><strong>min_method</strong> (<em>string</em><em>, </em><em>optional</em>) – Minimisation algorithms.</p></li>
<li><p><strong>volume_bound</strong> (<em>tuple-like</em><em>, </em><em>optional</em>) – equilibrium volumes. Unit: Angstrom^3</p></li>
<li><p><strong>mutewarning</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether print out warning messages.</p></li>
<li><p><strong>temperature</strong> (<em>array</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Unit: K</p></li>
<li><p><strong>pressure</strong> (<em>array</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Unit: GPa</p></li>
<li><p><strong>order</strong> (<em>int</em><em>, </em><em>optional</em>) – For DeltaFactor / Polynomial EOSs.</p></li>
<li><p><strong>min_ndata_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – For Numerical EOS.</p></li>
<li><p><strong>max_poly_order_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – For Numerical EOS.</p></li>
<li><p><strong>min_poly_order_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – For Numerical EOS.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>Valid entries of <code class="docutils literal notranslate"><span class="pre">eos_method</span></code> are consistent with <a class="reference external" href="https://pymatgen.org/pymatgen.analysis.eos.html">PyMatGen</a>.</p></li>
<li><dl class="simple">
<dt>Parameterized and tested algorithms for <code class="docutils literal notranslate"><span class="pre">min_method</span></code>:</dt><dd><ul class="simple">
<li><p>BFGS(no boundary)</p></li>
<li><p>L-BFGS-B(with boundary)</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<em>Quasi_harmonic</em>)</p>
</dd>
</dl>
<p><strong>New Attributes</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self.temperature</span></code> in K and <code class="docutils literal notranslate"><span class="pre">self.pressure</span></code> in GPa.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.volume</span></code>, nPressure*nTemperature. Equilibrium volumes. Unit: Angstrom^3</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.helmholtz</span></code> and <code class="docutils literal notranslate"><span class="pre">self.gibbs</span></code>, nPressure*nTemperature. Helmholtz and Gibbs free energies. Unit: kJ/mol</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.entropy</span></code>, nPressure*nTemperature, Entropy. Unit: J/mol*K</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.c_v</span></code>, nPressure*nTemperature, Constant volume specific heat. Unit: J/mol*K</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.e0_eos</span></code> and <code class="docutils literal notranslate"><span class="pre">self.e0_eos_method</span></code> Pymatgen EOS objects and string. EOS used to fit DFT energy.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If temperature or pressure is defined neither here nor during initialization.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics.Quasi_harmonic.thermo_gruneisen">
<span class="sig-name descname"><span class="pre">thermo_gruneisen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eos_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'birch_murnaghan'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BFGS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutewarning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics.Quasi_harmonic.thermo_gruneisen" title="Permalink to this definition"></a></dt>
<dd><p>Grüneisen parameters and related properties. The macroscopic Grüneisen
parameter is defined as:</p>
<div class="math notranslate nohighlight">
\[\gamma=\sum_{\textbf{q}i}\frac{\gamma_{\textbf{q}i}C_{V,\textbf{q}i}}{C_{V}}\]</div>
<p>Thermal expansion coefficient in Grüneisen model:</p>
<div class="math notranslate nohighlight">
\[\alpha_{V}^{gru}=\frac{\gamma C_{V}}{K_{T}V}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Grüneisen model is used to fit frequencies, equivalent to using
<code class="docutils literal notranslate"><span class="pre">self.thermo_freq(poly_order=[1,])</span></code>.</p>
</div>
<p>For arguments, see <code class="docutils literal notranslate"><span class="pre">self.thermo_freq</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self.gamma</strong> (<em>array</em>) – npressure*ntemperature array of macroscopic
Grüneisen parameter. Temperature should &gt; 0.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="CRYSTALpytools.thermodynamics._restore_pcel">
<span class="sig-name descname"><span class="pre">_restore_pcel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crysout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scelphono</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#CRYSTALpytools.thermodynamics._restore_pcel" title="Permalink to this definition"></a></dt>
<dd><p>Restore the primitive geometry expanded by ‘SCELPHONO’ and generate the
Pymatgen Structure of the cell used for phonon calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crysout</strong> (<a class="reference internal" href="crystalpytools.crystal_io.html#CRYSTALpytools.crystal_io.Crystal_output" title="CRYSTALpytools.crystal_io.Crystal_output"><em>Crystal_output</em></a>) – <code class="code docutils literal notranslate"><span class="pre">CRYSTALpytools.io.Crystal_output</span></code> object.</p></li>
<li><p><strong>scellphono</strong> (<em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>array</em><em>[</em><em>int</em><em>]</em>) – ndimension*ndimension or 3*3
matrix corresponds to the ‘SCELPHONO’ keyword.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>structures</strong> (<em>list[Structure]</em>) – A list of Pymatgen Structure objects.
nCalc*1. For HA phonons and dispersions, nCalc=1. For QHA,
nCalc=sampled HA points.</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="crystalpytools.plot.html" class="btn btn-neutral float-left" title="CRYSTALpytools.plot module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="crystalpytools.base.crysd12.html" class="btn btn-neutral float-right" title="CRYSTALpytools.base.crysd12 module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, CRYSTALpytools Development Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>